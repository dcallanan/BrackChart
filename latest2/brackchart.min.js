var brackChart_flags=[];function BrackChart(a){this.c={paddingX:60,paddingY:30,lineWidth:1},this.lc={matchWidth:230,matchHeight:130,lowestMatchY:0},this.rounds=this.createRounds(a),this.roundNames=[]}BrackChart.prototype.config=function(a){this.c=a},BrackChart.prototype.createRounds=function(a){var b=null,c=[];for(let[e,f]of a.entries()){var d=new BrackChartRound;d.c=this.c,d.lc=this.lc,d.setParent(b),d.setIndex(e),d.createFromData(f),c.push(d),b=d}return c},BrackChart.prototype.setRoundNames=function(a){for(let[c,d]of a.entries()){var b=new BrackChartRoundName(d,c);b.c=this.c,b.lc=this.lc,this.roundNames.push(b)}},BrackChart.prototype.createChart=function(a){var b=document.querySelector(a),c=new BrackChartElementFactory(b);c.c=this.c,c.lc=this.lc,b.classList.add("BrackChart_wrapper"),b.style.width=2*this.c.paddingX+this.rounds.length*(this.lc.matchWidth+this.c.paddingX)+"px";for(let d of this.rounds)for(let e of d.matches)c.createMatch(e),c.createLines(e.lines)};function BrackChartElementFactory(a){for(this.element=a,a.innerHTML="";a.firstChild;)a.removeChild(a.firstChild)}BrackChartElementFactory.prototype.createMatch=function(a){var b=document.createElement("div");b.classList.add("BrackChart_match"),b.style.width=a.width+"px",b.style.height=a.height+"px",b.style.top=a.y+"px",b.style.left=a.x+"px";var c=this.createMatchTeam(a.team1,a.score1,1==a.winner),d=this.createMatchTeam(a.team2,a.score2,2==a.winner),e=this.createMatchInfo(a.info),f=document.createElement("div");if(f.classList.add("BrackChart_scores"),f.appendChild(c),f.appendChild(e.element),f.appendChild(d),b.appendChild(f),a.info.moreInfo&&0<a.info.moreInfo.length){var g=document.createElement("div");g.classList.add("BrackChart_back"),g.innerText="BACK",g.style.top=this.lc.matchHeight-35+"px",g.style.width=this.lc.matchWidth+"px",g.onmousedown=()=>g.classList.add("active"),g.addEventListener("transitionend",()=>g.classList.remove("active")),g.addEventListener("webkitTransitionEnd",()=>g.classList.remove("active"));var h=document.createElement("div");h.classList.add("BrackChart_moreInfo");for(var j of a.info.moreInfo)h.appendChild(this.createMatchMoreInfoText(j));h.appendChild(g),b.appendChild(h),h.style.transform="translateX(100%) translateY(-"+a.height+"px)",e.button.onclick=function(){f.classList.add("hidden"),h.style.transform="translateX(0%) translateY(-"+a.height+"px)"},g.onclick=function(){f.classList.remove("hidden"),h.style.transform="translateX(100%) translateY(-"+a.height+"px)"}}this.element.appendChild(b)},BrackChartElementFactory.prototype.createMatchInfo=function(a){var b=null,c=document.createElement("div");c.classList.add("BrackChart_info");var d=document.createElement("div");d.classList.add("BrackChart_time"),d.innerHTML=a.time;var e=document.createElement("div");return e.classList.add("BrackChart_date"),e.innerHTML=a.date,c.appendChild(d),c.appendChild(e),void 0!==a.moreInfo&&0<a.moreInfo.length&&(b=document.createElement("div"),b.classList.add("BrackChart_button"),b.innerHTML="MORE INFO",b.addEventListener("webkitTransitionEnd",()=>b.classList.remove("active")),b.addEventListener("transitionend",()=>b.classList.remove("active")),c.appendChild(b),b.onmousedown=()=>b.classList.add("active")),{element:c,button:b}},BrackChartElementFactory.prototype.createMatchMoreInfoText=function(a){var b=document.createElement("div");return b.classList.add("BrackChart_moreInfoText"),b.innerText=a,b},BrackChartElementFactory.prototype.createMatchTeam=function(a,b){var d=document.createElement("div");d.classList.add("BrackChart_team");var e=brackChart_flags[a];if(!e){let l=document.createElement("div");l.classList.add("BrackChart_flag"),l.style.backgroundColor="#444",l.style.width="50px",d.appendChild(l)}else if(Array.isArray(e)){for(var f of e){let l=document.createElement("div");l.classList.add("BrackChart_flag"),l.style.backgroundColor="#"+f,l.style.width=48/e.length+"px",d.appendChild(l)}var g=e[e.length-1];if("ffffff"==g){let l=document.createElement("div");l.classList.add("BrackChart_flag"),l.style.backgroundColor="#"+g,l.style.width="1px",d.appendChild(l);let m=document.createElement("div");m.classList.add("BrackChart_flag"),m.style.backgroundColor="#ccc",m.style.width="1px",d.appendChild(m)}else{let l=document.createElement("div");l.classList.add("BrackChart_flag"),l.style.backgroundColor="#"+g,l.style.width="2px",d.appendChild(l)}}else{var h=document.createElement("img");h.src=e,h.style.width="50px",h.style.height="45px",d.appendChild(h)}var j=document.createElement("div");j.classList.add("BrackChart_teamName"),j.innerHTML=a;var k=document.createElement("div");return k.classList.add("BrackChart_teamScore"),k.innerHTML=b,d.appendChild(j),d.appendChild(k),d},BrackChartElementFactory.prototype.createLines=function(a){for(var b of a)this.createLine(b)},BrackChartElementFactory.prototype.createLine=function(a){var b=document.createElement("div");if(b.classList.add("BrackChart_line"),a.x1){var c=a.x2-a.x1;b.style.width=c+"px",b.style.height=this.c.lineWidth+"px",b.style.left=a.x1+"px",b.style.top=a.y-this.c.lineWidth/2+"px"}else{var d=a.y2-a.y1;b.style.width=this.c.lineWidth+"px",b.style.height=d+"px",b.style.left=a.x-this.c.lineWidth/2+"px",b.style.top=a.y1+"px"}this.element.appendChild(b)};function BrackChartMatch(a){this.parent1=null,this.parent2=null,this.round=a,this.info={},this.lines=[]}BrackChartMatch.prototype.initParents=function(a,b,c){b&&(this.parent1=a.getMatch(2*c),this.parent2=a.getMatch(2*c+1))},BrackChartMatch.prototype.updateDimensions=function(){this.x=this.c.paddingX+this.xIndex*(this.lc.matchWidth+this.c.paddingX),this.y=this.hasParents()?(this.parent1.y+this.parent2.y)/2:0==this.yIndex?this.c.paddingY:this.round.getMatch(this.yIndex-1).y+this.lc.matchHeight+this.c.paddingY,this.width=this.lc.matchWidth,this.height=this.lc.matchHeight,this.y>this.lc.lowestMatchY&&(this.lc.lowestMatchY=this.y)},BrackChartMatch.prototype.createLines=function(){if(this.hasParents()){var a=this.parent1.winner,b=this.parent2.winner,c=this.lc.matchHeight/4,d=this.parent1.y+this.lc.matchHeight/2+(1==a?-c/4:2==a?c:0),e=this.parent2.y+this.lc.matchHeight/2+(1==b?-c/4:2==b?c:0);this.lines.push({x:this.x-this.c.paddingX/2,y1:d,y2:e}),this.lines.push({x1:this.x-this.c.paddingX,x2:this.x-this.c.paddingX/2,y:d}),this.lines.push({x1:this.x-this.c.paddingX,x2:this.x-this.c.paddingX/2,y:e}),this.lines.push({x1:this.x-this.c.paddingX/2,x2:this.x,y:this.y+this.c.paddingY})}},BrackChartMatch.prototype.setIndex=function(a,b){this.xIndex=a,this.yIndex=b},BrackChartMatch.prototype.setTeams=function(a,b){this.team1=a,this.team2=b},BrackChartMatch.prototype.setScores=function(a,b){this.score1=a,this.score2=b},BrackChartMatch.prototype.setWinner=function(a){this.winner=a,this.winnerName=null==a?null:this["team"+a]},BrackChartMatch.prototype.setInfo=function(a){this.info=a},BrackChartMatch.prototype.hasParents=function(){return this.parent1||this.parent2};function BrackChartRound(){this.parent=null,this.index=null,this.matches=[]}BrackChartRound.prototype.setParent=function(a){this.parent=a},BrackChartRound.prototype.setIndex=function(a){this.index=a},BrackChartRound.prototype.createFromData=function(a){var b=0;for(let[d,e]of a.entries()){var c=new BrackChartMatch(this);c.c=this.c,c.lc=this.lc,c.setTeams(e.team1,e.team2),c.setScores(e.score1,e.score2),c.setWinner(e.winner),c.setInfo(e.info),c.setIndex(this.index,d),c.initParents(this.parent,e.connectsFrom,b),c.updateDimensions(),c.createLines(),this.matches.push(c),console.log(e),e.info.prev||b++}},BrackChartRound.prototype.getMatch=function(a){return this.matches[a]};function BrackChartRoundName(a,b){this.text=a,this.index=b}BrackChartRoundName.prototype.createElement=function(){var a=document.createElement("div");a.classList.add("BrackChart_title"),a.style.top=this.c.paddingY+"px",a.style.left=this.c.paddingX+(this.lc.matchWidth+this.c.paddingX)*xIndex+"px",a.innerText=text};